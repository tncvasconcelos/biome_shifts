Codes and datasets used in: Rates of biome shift predict diversification dynamics in flowering plants (submitted)

Authors:
James D. Boyko and Thais Vasconcelos


----
Description of folders: 
 
- **1_occurrence_data/** 
  
Folder containing filtered occurrence points and list of biomes where species occur. 


- **2_trees/** 
 
Folder containing original taxized tree files used in all analyses. 

- **3_organized_datasets_muhisse/** 
  
Folder containing input files for muhisse analyses.


- **4_organized_trees_muhisse/**

Folder containing input trees for muhisse analyses.

- **5_results/** 
  
.Rdata files containing results of muhisse from 05_run_muhisse.R. the muhisse objects are saved as 'res.'

- **6_recons/**
  
.Rdata files containing ancestral state reconstructions from 06_muhisse_recon.R. the recon objects are saved as 'recon.'

- **plots/**

 Folder for output of plotting calls.

- **tables/**
  
Ancestral state reconstruction results

- **taxized_reference_tables/**

Reference tables containing POWO names in one column and GBIF names in another. Useful for harmonizing taxonomic backbone before running GBIF queries.
 

----
Scripts:

> 00_utility_functions.R
  
Script containing custom functions necessary to run all following scripts. Often these functions are used repeatedly in different scripts.


> 01_taxizing_trees.R

Finds names for species sampled in the trees under the GBIF taxonomic backbone. 

> 02_sending_names_gbif.R
  
Runs a GBIF query for taxized species names sampled in the trees.

> 03_clean_gbif.R

Filters GBIF occurrence points according to the POWO shapefiles and some common problems (see methods).

> 04_get_biome_type.R
  
Uses the filtered occurrence points to find the prevalent biome types for each species.

> 05_run_muhisse.R
  
Loads processed data from previous scripts and formats the data to match muhisse model specificiations. Then creates a set of muhisse models which allow for character dependent and character independent rate hetoergeneity. Fits and saves the muhisse models for all data.

> 06_muhisse_recon.R
  
Performs ancestral state reconstruction on previous muhisse results (see 05_run_muhisse.R).
  
> 07_muhisse_table.R
  
Summarizes the parameters of previous muhisse results (see 05_run_muhisse.R). This summarization includes model averaging based on AIC weight of each model applied to each dataset. This script produces the table 'all_par_table.csv' containing model averaged parameters. 

> 08_muhisse_plots.R
  
Generates plots based on the data from 'all_par_table.csv'. Additionally, runs significance tests via phylogenetic t-tests and phylogenetic generalized least squares regression. 


----
Other files:

> WCVP_life_form_description.txt

> all_par_table.csv
Tabular data summarizing the muhisse results for each clade. Each row represents a different clade analyzed. Columns A through U contains model averaged parameter estimates. Columns V through Y contains the sum of the AIC weight supporting particular rate heterogeneity scenarios. Column Z contains the number of taxa for each clade used in the analysis. Generated by 07_muhisse_table.R

----
Distribution data comes from:
GBIF.org (04 May 2023) GBIF Occurrence Download https://doi.org/10.15468/dl.9y3t82

